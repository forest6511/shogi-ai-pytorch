---
name: test-e2e
description: Playwright MCPでWeb UIの動作を実対局テストする。第15章のWeb UIが正しく動くかを確認したいときに使う。
disable-model-invocation: true
allowed-tools: Bash(uv run shogi-ai*)
---

# test-e2e — Web UI E2Eテスト

Playwright MCPを使ってWeb UIを実際にブラウザで操作し、対局が完了できるかを検証する。

## 前提: Playwright MCPの確認

`settings.json` に Playwright MCP が設定済み。Claude Code 起動時に自動で有効になる。
MCP が使えない場合は `/mcp` コマンドでステータスを確認すること。

## 前提: Web UIの起動

```bash
uv run shogi-ai web
# → http://localhost:8000 で起動
```

別ターミナルで起動したまま、以下のテストを実行する。

---

## テスト 1: ページ読み込み

- `http://localhost:8000` にアクセスする
- 将棋盤が表示されること
- 駒が初期位置に配置されること
- モード選択（どうぶつしょうぎ / 本将棋 / 観戦）が表示されること

---

## テスト 2: どうぶつしょうぎ対局

1. 「どうぶつしょうぎ」モードを選択する
2. 先手の駒をクリックする → 合法手がハイライトされること
3. ハイライトされたマスをクリックする → 駒が移動すること
4. AI（後手）が自動で応答して指すこと
5. ゲーム終了（獅子を取る / トライ）が正しく検出されること

---

## テスト 3: 本将棋対局

1. 「本将棋」モードを選択する
2. 歩を前に進める → 移動が受け付けられること
3. 相手陣に駒が入ったとき → 成り確認ダイアログが表示されること
4. 不正な手（合法手外）をクリックする → 受け付けられないこと

---

## テスト 4: AI vs AI 観戦モード

1. 「観戦」モードを選択する
2. AIが自動で対局を進めること
3. 引き分けまたは勝敗が正しく検出されること

---

## 合格基準（Phase 9 検証基準）

- 対局を最後まで完了できる
- 不正な手が受け付けられない
- AIが毎ターン応答する（タイムアウトなし）
- ブラウザのコンソールにエラーが出ていない
